Function HandlePopUps(e) ' [KEYWORD=TRUE] '@L4	Dim strDialogText	Err.Clear: On Error GoTo 0	On Error Resume Next	Set s = Evaluate(e)	If s("run") = 1 Then		Set stepReference = s("obj")		stepData = e("data_in") 		If Trim(stepData) = "" Then stepData = "&OK"		intBrowserCount = myPactera_commonFunction_getActiveBrowserIndex		Set objWebBrowser = Browser("CreationTime:=" & intBrowserCount)		strDialogText = "text:=.*Message from webpage.*|.*Internet.*|.*Explorer.*|.*Print.*|.*Save.*|.*File.*|.*Open.*|.*Window.*|.*Download.*|.*Security.*|.*Warning.*"		If objWebBrowser.Exist(1) Then			Set tmpDialog = objWebBrowser.Dialog(strDialogText, "nativeclass:=#32770", "index:=0")			While tmpDialog.Exist(1)				tmpDialog.Highlight				If tmpDialog.WinButton("text:=" & strProperties).Exist(0) Then					tmpDialog.WinButton("text:=" & strProperties).Click				Else					If tmpDialog.WinButton("text:=&" & strProperties).Exist(0) Then						tmpDialog.WinButton("text:=&" & strProperties).Click					End If				End If				If tmpDialog.WinButton("text:=" & "OK").Exist(0) Then					tmpDialog.WinButton("text:=" & "OK").Click				Else					If tmpDialog.WinButton("text:=&" & "OK").Exist(0) Then						tmpDialog.WinButton("text:=&" & "OK").Click					End If				End If				If Trim(UCase(strProperties)) = "\CLOSE" Or Trim(UCase(strProperties)) = "/CLOSE" Then					tmpDialog.Close				End If				If tmpDialog.Exist(0) Then tmpDialog.Close				Set tmpDialog = objWebBrowser.Dialog(strDialogText, "nativeclass:=#32770", "index:=0")			Wend			Set tmpDialog = objWebBrowser.Page("index:=0").JavaApplet("index:=0").JavaDialog("index:=0")			While tmpDialog.Exist(1)				tmpDialog.Highlight				If tmpDialog.JavaButton("attached text:=" & strProperties).Exist(0) Then					tmpDialog.JavaButton("attached text:=" & strProperties).Click				Else					If tmpDialog.JavaButton("attached text:=&" & strProperties).Exist(0) Then						tmpDialog.JavaButton("attached text:=&" & strProperties).Click					End If				End If				If tmpDialog.JavaButton("attached text:=" & "OK").Exist(0) Then					tmpDialog.WinButton("attached text:=" & "OK").Click				Else					If tmpDialog.JavaButton("attached text:=&" & "OK").Exist(0) Then						tmpDialog.JavaButton("attached text:=&" & "OK").Click					End If				End If				If Trim(UCase(strProperties)) = "\CLOSE" Or Trim(UCase(strProperties)) = "/CLOSE" Then					tmpDialog.Close				End If				If tmpDialog.Exist(0) Then tmpDialog.Close				Set tmpDialog = objWebBrowser.JavaDialog("index:=0")			Wend		End If	End If	Set HandlePopUps = EvaluateExecution(Err, "")	Err.Clear: On Error GoTo 0End Function